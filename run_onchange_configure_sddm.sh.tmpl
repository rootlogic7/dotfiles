#!/bin/bash

# Pfade definieren
# {{ .chezmoi.sourceDir }} wird von chezmoi automatisch durch den richtigen Pfad ersetzt
SOURCE_FILE="{{ .chezmoi.sourceDir }}/system/sddm/theme.conf"
DEST_DIR="/etc/sddm.conf.d"
DEST_FILE="$DEST_DIR/theme.conf"

# HASH-TRICK:
# Wir fügen den Hash der Config-Datei als Kommentar ein.
# Ändert sich die Config, ändert sich der Hash -> Skript läuft erneut.
# theme.conf hash: {{ include "system/sddm/theme.conf" | sha256sum }}

echo "⚙️  Konfiguriere SDDM Theme..."

# 1. Zielordner erstellen, falls nicht vorhanden
if [ ! -d "$DEST_DIR" ]; then
    echo "Ordner $DEST_DIR wird erstellt..."
    sudo mkdir -p "$DEST_DIR"
fi

# 2. Datei kopieren
# Wir nutzen 'install', das ist sauberer als cp (setzt Rechte gleich richtig)
sudo install -m 644 "$SOURCE_FILE" "$DEST_FILE"

echo "✅ SDDM Config aktiviert: $DEST_FILE"
